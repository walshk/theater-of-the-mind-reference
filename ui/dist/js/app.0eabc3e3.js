(function(){"use strict";var r={5016:function(r,e,t){var o=t(6369),a=function(){var r=this,e=r._self._c;r._self._setupProxy;return e("div",{attrs:{id:"app"}},[e("BattleMap")],1)},i=[],n=function(){var r=this,e=r._self._c;r._self._setupProxy;return e("b-container",{staticClass:"battle-map",attrs:{fluid:""}},[e("b-row",{staticClass:"fullHeight"},[e("b-col",{staticClass:"fullHeight",staticStyle:{"padding-left":"0","padding-right":"1px"}},[e("svg",{ref:"map",staticClass:"battle-map-svg",attrs:{width:"100%",height:"100%",viewBox:"0 0 1000 1000"},on:{mousemove:r.onMousemove,mouseup:r.putDownMarker}},r._l(r.markers,(function(t,o){return e("EntityMarker",{key:`${t.name}-${o}`,attrs:{marker:t,dragging:r.isDragging},on:{editMarker:r.editMarker,pickUp:r.pickUpMarker}})})),1)]),e("b-col",{staticClass:"fullHeight d-none d-lg-block",attrs:{lg:"3"}},[e("MarkerBuilder",{attrs:{marker:r.editingMarker},on:{createMarker:r.addMarker,updateMarker:r.updateMarker,cancelEdit:r.cancelEditMarker,removeMarker:r.removeMarker}})],1)],1)],1)},s=[];t(7658);class l{constructor(){Object.defineProperty(this,"markers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.markers=[]}getMarkers(){return this.markers}addMarker(r){this.markers.push(r)}removeMarker(r){this.markers=this.markers.filter((e=>e.id!==r))}}var c=t(3029);class m{constructor(r,e,t,o,a,i,n){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=null!==n&&void 0!==n?n:(0,c.Z)(),this.name=r,this.color=e,this.fontColor=t,this.x=o,this.y=a,this.radius=i}setName(r){this.name=r}setColor(r){this.color=r}setFontColor(r){this.fontColor=r}setRadius(r){this.radius=r}moveMarkerTo(r,e){this.x=r,this.y=e}moveMarkerToSmooth(r,e){const t=r-this.x,o=e-this.y,a=t/100,i=o/100;let n=0;const s=setInterval((()=>{100===n?clearInterval(s):(this.x+=a,this.y+=i,n+=1)}),1)}toString(){return JSON.stringify({id:this.id,name:this.name,color:this.color,fontColor:this.fontColor,x:this.x,y:this.y,radius:this.radius})}}var u=function(){var r=this,e=r._self._c;r._self._setupProxy;return e("g",{ref:"marker",staticClass:"entity-marker",style:r.markerStyles,on:{mousedown:r.pickUp,contextmenu:function(e){return r.edit.apply(null,arguments)}}},[e("circle",{staticClass:"border-circle",attrs:{fill:"black",cx:r.marker.x,cy:r.marker.y,r:r.marker.radius+2}}),e("circle",{attrs:{fill:r.marker.color,cx:r.marker.x,cy:r.marker.y,r:r.marker.radius}}),e("text",{staticClass:"marker-name",style:"font-size: "+r.marker.radius/2,attrs:{x:r.marker.x,y:r.marker.y,fill:r.marker.fontColor,"text-anchor":"middle",dy:".3em"}},[r._v(" "+r._s(r.marker.name)+" ")])])},f=[],d=function(r,e,t,o){function a(r){return r instanceof t?r:new t((function(e){e(r)}))}return new(t||(t=Promise))((function(t,i){function n(r){try{l(o.next(r))}catch(e){i(e)}}function s(r){try{l(o["throw"](r))}catch(e){i(e)}}function l(r){r.done?t(r.value):a(r.value).then(n,s)}l((o=o.apply(r,e||[])).next())}))},k=o["default"].extend({name:"EntityMarker",props:{marker:m,dragging:Boolean},methods:{pickUp(r){return d(this,void 0,void 0,(function*(){r.preventDefault(),2!==r.button&&this.$emit("pickUp",this.marker)}))},edit(r){r.preventDefault(),this.$emit("editMarker",this.marker)}},computed:{markerStyles(){const r=this.dragging?"grabbing":"grab";return{"--hover-cursor":r}}}}),h=k,p=t(1001),b=(0,p.Z)(h,u,f,!1,null,"7593d470",null),v=b.exports,g=function(){var r=this,e=r._self._c;r._self._setupProxy;return e("b-container",{staticClass:"marker-builder",attrs:{fluid:""}},[e("b-row",{staticStyle:{"margin-bottom":"1rem"}},[e("b-col",[e("h3",[r._v("Add New Marker")])])],1),e("b-row",[e("b-col",[e("b-form",{on:{submit:r.submit}},[e("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-name-group",label:"Label","label-for":"marker-label"}},[e("b-form-input",{attrs:{id:"marker-label",type:"text"},model:{value:r.form.name,callback:function(e){r.$set(r.form,"name",e)},expression:"form.name"}})],1),e("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-color-group",label:"Marker Color","label-for":"marker-color"}},[e("b-form-input",{attrs:{id:"marker-color",type:"color"},model:{value:r.form.color,callback:function(e){r.$set(r.form,"color",e)},expression:"form.color"}})],1),e("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-font-color-group",label:"Font Color","label-for":"marker-color"}},[e("b-form-input",{attrs:{id:"marker-font-color",type:"color"},model:{value:r.form.fontColor,callback:function(e){r.$set(r.form,"fontColor",e)},expression:"form.fontColor"}})],1),e("b-form-group",{attrs:{id:"input-name-group",label:"Size","label-for":"marker-size"}},[e("b-form-select",{attrs:{id:"marker-size",options:r.sizeOptions},model:{value:r.form.size,callback:function(e){r.$set(r.form,"size",e)},expression:"form.size"}})],1)],1)],1)],1),e("b-row",{staticStyle:{"text-align":"center"}},[e("b-col",[e("svg",{attrs:{width:"100%",height:"100%",viewBox:"0 0 300 300"}},[e("g",{staticClass:"entity-marker"},[e("circle",{staticClass:"border-circle",attrs:{fill:"black",cx:150,cy:150,r:+r.form.size+2}}),e("circle",{attrs:{fill:r.form.color,cx:150,cy:150,r:+r.form.size}}),e("text",{staticClass:"marker-name",style:"font-size: "+ +r.form.size/2,attrs:{x:150,y:150,fill:r.form.fontColor,"text-anchor":"middle",dy:".3em"}},[r._v(" "+r._s(r.form.name)+" ")])])])])],1),e("b-row",{staticStyle:{"text-align":"center"}},[e("b-col",[r.marker?r._e():e("b-button",{attrs:{variant:"success"},on:{click:r.createMarker}},[r._v("Add Marker")]),r.marker?e("b-button",{attrs:{variant:"success"},on:{click:r.updateMarker}},[r._v(" Update Marker ")]):r._e(),r.marker?e("b-button",{staticStyle:{"margin-left":"1rem"},attrs:{variant:"secondary"},on:{click:r.deselectMarker}},[r._v(" Cancel ")]):r._e()],1)],1),e("b-row",{staticStyle:{"text-align":"center","margin-top":"3rem"}},[e("b-col",[r.marker?e("b-button",{attrs:{variant:"danger"},on:{click:r.removeMarker}},[r._v("Remove Marker")]):r._e()],1)],1)],1)},M=[],y=o["default"].extend({name:"MarkerBuilder",props:{marker:m},mounted(){this.marker&&(this.form.name=this.marker.name,this.form.color=this.marker.color,this.form.fontColor=this.marker.fontColor,this.form.size=this.marker.radius)},data(){return{form:{name:"",color:"#00BFFF",fontColor:"#000",size:50},formDefaults:{name:"",color:"#00BFFF",fontColor:"#000",size:50},sizeOptions:[{text:"Tiny",value:25},{text:"Small/Medium",value:50},{text:"Large",value:100},{text:"Huge",value:150},{text:"Gargantuan",value:200}]}},methods:{submit(r){r.preventDefault(),this.marker?this.updateMarker():this.createMarker()},createMarker(){this.$emit("createMarker",this.form),this.form.name=""},updateMarker(){this.marker.setName(this.form.name),this.marker.setColor(this.form.color),this.marker.setFontColor(this.form.fontColor),this.marker.setRadius(+this.form.size),this.$emit("updateMarker"),this.form=Object.assign({},this.formDefaults)},removeMarker(){this.marker&&(this.$emit("removeMarker",this.marker.id),this.form=Object.assign({},this.formDefaults))},deselectMarker(){this.$emit("cancelEdit"),this.form=Object.assign({},this.formDefaults)}},watch:{marker:function(r){r&&(this.form.name=r.name,this.form.color=r.color,this.form.fontColor=r.fontColor,this.form.size=r.radius)}}}),x=y,C=(0,p.Z)(x,g,M,!1,null,null,null),w=C.exports,_=t(7851);const O=`https://${window.location.host}`,S=(0,_.io)(O);S.on("connect",(()=>{console.log("connected to server"),S.emit("getMarkers")})),S.on("disconnect",(()=>{console.log("disconnected from server")}));var T=S,j=o["default"].extend({name:"BattleMap",components:{EntityMarker:v,MarkerBuilder:w},mounted(){this.map=new l,T.on("markerError",(r=>{this.$bvToast.toast(r,{title:"Marker Error",variant:"warning"})})),T.on("addMarker",(r=>{const e=JSON.parse(r),t=new m(e.name,e.color,e.fontColor,e.x,e.y,e.radius,e.id);this.map.addMarker(t)})),T.on("markerMoved",(r=>{const e=JSON.parse(r),t=this.map.markers.find((r=>r.id===e.id));t&&t.moveMarkerToSmooth(e.x,e.y)})),T.on("removeMarker",(r=>{this.map.removeMarker(r)})),T.on("updateMarkerTraits",(r=>{const e=JSON.parse(r),t=this.map.markers.find((r=>r.id===e.id));t&&(t.setName(e.name),t.setColor(e.color),t.setFontColor(e.fontColor),t.setRadius(e.radius))}))},data(){return{map:new l,selectedMarker:void 0,editingMarker:void 0,isDragging:!1,currentLocation:{x:0,y:0}}},methods:{addMarker(r){const{name:e,color:t,fontColor:o,size:a}=r,i=new m(e,t,o,500,500,+a);this.map.addMarker(i),T.emit("addMarker",i.toString())},onMousemove(r){if(r.preventDefault(),this.selectedMarker&&this.isDragging&&this.screenCTM){const e=(r.clientX-this.screenCTM.e)/this.screenCTM.a,t=(r.clientY-this.screenCTM.f)/this.screenCTM.d;this.selectedMarker.moveMarkerTo(e,t)}this.currentLocation={x:r.clientX,y:r.clientY}},markerMoved(r){T.emit("moveMarker",JSON.stringify(r))},removeMarker(r){this.map.removeMarker(r),this.editingMarker=void 0,T.emit("removeMarker",r)},pickUpMarker(r){this.selectedMarker=r,this.isDragging=!0},putDownMarker(){if(this.selectedMarker&&this.isDragging){this.isDragging=!1;const r={id:this.selectedMarker.id,x:this.selectedMarker.x,y:this.selectedMarker.y};T.emit("moveMarker",JSON.stringify(r))}},editMarker(r){this.editingMarker=r},updateMarker(){if(!this.editingMarker)return;const r=JSON.stringify(this.editingMarker);this.editingMarker=void 0,T.emit("updateMarkerTraits",r)},cancelEditMarker(){this.editingMarker=void 0}},computed:{markers(){return this.map.getMarkers()},screenCTM(){const r=this.$refs.map;return r.getScreenCTM()}}}),z=j,P=(0,p.Z)(z,n,s,!1,null,"172a90c5",null),$=P.exports,D=o["default"].extend({name:"App",components:{BattleMap:$}}),B=D,F=(0,p.Z)(B,a,i,!1,null,null,null),N=F.exports,E=t(3702),J=t(9425),U=t(7581);t(7024);o["default"].use(E.XG7),o["default"].use(J.A7),o["default"].use(U.m$),o["default"].config.productionTip=!1,T.connect(),new o["default"]({render:r=>r(N)}).$mount("#app")}},e={};function t(o){var a=e[o];if(void 0!==a)return a.exports;var i=e[o]={exports:{}};return r[o].call(i.exports,i,i.exports,t),i.exports}t.m=r,function(){var r=[];t.O=function(e,o,a,i){if(!o){var n=1/0;for(m=0;m<r.length;m++){o=r[m][0],a=r[m][1],i=r[m][2];for(var s=!0,l=0;l<o.length;l++)(!1&i||n>=i)&&Object.keys(t.O).every((function(r){return t.O[r](o[l])}))?o.splice(l--,1):(s=!1,i<n&&(n=i));if(s){r.splice(m--,1);var c=a();void 0!==c&&(e=c)}}return e}i=i||0;for(var m=r.length;m>0&&r[m-1][2]>i;m--)r[m]=r[m-1];r[m]=[o,a,i]}}(),function(){t.n=function(r){var e=r&&r.__esModule?function(){return r["default"]}:function(){return r};return t.d(e,{a:e}),e}}(),function(){t.d=function(r,e){for(var o in e)t.o(e,o)&&!t.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:e[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){if("object"===typeof window)return window}}()}(),function(){t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)}}(),function(){t.r=function(r){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}}(),function(){var r={143:0};t.O.j=function(e){return 0===r[e]};var e=function(e,o){var a,i,n=o[0],s=o[1],l=o[2],c=0;if(n.some((function(e){return 0!==r[e]}))){for(a in s)t.o(s,a)&&(t.m[a]=s[a]);if(l)var m=l(t)}for(e&&e(o);c<n.length;c++)i=n[c],t.o(r,i)&&r[i]&&r[i][0](),r[i]=0;return t.O(m)},o=self["webpackChunkui"]=self["webpackChunkui"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(5016)}));o=t.O(o)})();
//# sourceMappingURL=app.0eabc3e3.js.map