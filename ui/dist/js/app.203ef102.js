(function(){"use strict";var e={3115:function(e,r,t){var i=t(6369),o=function(){var e=this,r=e._self._c;e._self._setupProxy;return r("div",{attrs:{id:"app"}},[r("BattleMap")],1)},a=[],s=function(){var e=this,r=e._self._c;e._self._setupProxy;return r("b-container",{staticClass:"battle-map",attrs:{fluid:""}},[r("b-row",{staticClass:"fullHeight"},[r("b-col",{staticClass:"fullHeight",staticStyle:{"padding-left":"0","padding-right":"1px"},attrs:{id:"battleMapCol"}},[r("svg",{ref:"map",staticClass:"battle-map-svg",attrs:{width:"100%",height:"100%",viewBox:"0 0 1000 1000"},on:{mousemove:e.onMousemove,mouseup:e.putDownMarker}},[r("defs",[r("pattern",{attrs:{id:"grid",width:"80",height:"80",patternUnits:"userSpaceOnUse"}},[r("path",{attrs:{d:"M 80 0 L 0 0 0 80",fill:"none",stroke:"gray","stroke-width":"1"}})])]),r("rect",{attrs:{x:"-1000",y:"0",width:"3000",height:"1000",fill:"url(#grid)"}}),e._l(e.markers,(function(t,i){return r("EntityMarker",{key:`${t.name}-${i}`,attrs:{marker:t,dragging:e.isDragging},on:{editMarker:e.editMarker,pickUp:e.pickUpMarker}})}))],2),r("div",{ref:"trashArea",style:e.trashAreaStyle,attrs:{id:"trashArea"},on:{mousemove:e.onMousemove,mouseup:e.putDownMarker}},[r("b-icon-trash",{staticStyle:{"margin-right":"1rem"}}),r("span",[e._v("Drag Here to Delete")])],1)]),r("b-col",{staticClass:"fullHeight d-none d-lg-block",attrs:{lg:"3"}},[r("MarkerBuilder",{attrs:{marker:e.editingMarker},on:{createMarker:e.addMarker,updateMarker:e.updateMarker,cancelEdit:e.cancelEditMarker,removeMarker:e.removeMarker}})],1)],1)],1)},n=[];t(7658);class l{constructor(){Object.defineProperty(this,"markers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.markers=[]}getMarkers(){return this.markers}addMarker(e){this.markers.push(e)}removeMarker(e){this.markers=this.markers.filter((r=>r.id!==e))}}var c=t(3029);class m{constructor(e,r,t,i,o,a,s="",n=0,l){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"condition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=null!==l&&void 0!==l?l:(0,c.Z)(),this.name=e,this.color=r,this.fontColor=t,this.x=i,this.y=o,this.radius=a,this.condition=s,this.height=n}setName(e){this.name=e}setColor(e){this.color=e}setFontColor(e){this.fontColor=e}setRadius(e){this.radius=e}setCondition(e){this.condition=e}setHeight(e){this.height=e}moveMarkerTo(e,r){this.x=e,this.y=r}moveMarkerToSmooth(e,r){const t=e-this.x,i=r-this.y,o=t/100,a=i/100;let s=0;const n=setInterval((()=>{100===s?clearInterval(n):(this.x+=o,this.y+=a,s+=1)}),1)}toString(){return JSON.stringify({id:this.id,name:this.name,color:this.color,fontColor:this.fontColor,x:this.x,y:this.y,radius:this.radius,condition:this.condition,height:this.height})}}var d=function(){var e=this,r=e._self._c;e._self._setupProxy;return r("g",{ref:"marker",staticClass:"entity-marker",style:e.markerStyles,on:{mousedown:e.pickUp,contextmenu:function(r){return e.edit.apply(null,arguments)}}},[e.marker.condition.length>0?r("circle",{staticClass:"circle",attrs:{cx:e.marker.x,cy:e.marker.y,r:e.marker.radius+4,fill:"none",stroke:"red","stroke-width":"5px","stroke-dasharray":"1",opacity:"0.7"}}):e._e(),r("circle",{staticClass:"border-circle",attrs:{fill:"black",cx:e.marker.x,cy:e.marker.y,r:e.marker.radius}}),r("circle",{attrs:{fill:e.marker.color,cx:e.marker.x,cy:e.marker.y,r:e.marker.radius-2}}),r("text",{staticClass:"marker-name",style:"font-size: "+e.marker.radius/2,attrs:{x:e.marker.x,y:e.marker.y,fill:e.marker.fontColor,"text-anchor":"middle",dy:".3em"}},[e._v(" "+e._s(e.marker.name)+" ")]),r("text",{staticClass:"condition-text",style:"font-size: 12px;",attrs:{x:e.marker.x,y:e.marker.y+e.marker.radius+16,fill:"#000","text-anchor":"middle"}},[e._v(" "+e._s(e.marker.condition)+" ")]),r("text",{staticClass:"height-text",style:`font-size: ${e.marker.radius/3}px;`,attrs:{x:e.marker.x,y:e.marker.y+e.marker.radius/1.5,"text-anchor":"middle",fill:"#000"}},[e._v(" "+e._s(e.markerHeight)+" ")])])},h=[],u=function(e,r,t,i){function o(e){return e instanceof t?e:new t((function(r){r(e)}))}return new(t||(t=Promise))((function(t,a){function s(e){try{l(i.next(e))}catch(r){a(r)}}function n(e){try{l(i["throw"](e))}catch(r){a(r)}}function l(e){e.done?t(e.value):o(e.value).then(s,n)}l((i=i.apply(e,r||[])).next())}))},f=i["default"].extend({name:"EntityMarker",props:{marker:m,dragging:Boolean},methods:{pickUp(e){return u(this,void 0,void 0,(function*(){e.preventDefault(),2!==e.button&&this.$emit("pickUp",{marker:this.marker,ref:this.$refs.marker})}))},edit(e){e.preventDefault(),this.$emit("editMarker",this.marker)}},computed:{markerStyles(){const e=this.dragging?"grabbing":"grab",r=this.marker.height>0?"drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4))":"drop-shadow(0)";return{"--hover-cursor":e,"--marker-shadow":r}},borderColor(){return this.marker.condition.length>0?"red":"black"},markerHeight(){return+this.marker.height>0?`${this.marker.height}ft`:""}}}),k=f,g=t(1001),p=(0,g.Z)(k,d,h,!1,null,"4b371b2e",null),b=p.exports,v=function(){var e=this,r=e._self._c;e._self._setupProxy;return r("b-container",{staticClass:"marker-builder",attrs:{fluid:""}},[r("b-row",{staticStyle:{"margin-bottom":"1rem"}},[r("b-col",[e.marker?r("h3",[e._v("Edit Marker")]):r("h3",[e._v("Add New Marker")])])],1),r("b-row",[r("b-col",[r("b-form",{on:{submit:e.submit}},[r("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-name-group",label:"Label","label-for":"marker-label"}},[r("b-form-input",{attrs:{id:"marker-label",type:"text"},model:{value:e.form.name,callback:function(r){e.$set(e.form,"name",r)},expression:"form.name"}})],1),r("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-color-group",label:"Marker Color","label-for":"marker-color"}},[r("b-form-input",{attrs:{id:"marker-color",type:"color"},model:{value:e.form.color,callback:function(r){e.$set(e.form,"color",r)},expression:"form.color"}})],1),r("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-font-color-group",label:"Font Color","label-for":"marker-font-color"}},[r("b-form-input",{attrs:{id:"marker-font-color",type:"color"},model:{value:e.form.fontColor,callback:function(r){e.$set(e.form,"fontColor",r)},expression:"form.fontColor"}})],1),r("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-name-group",label:"Size","label-for":"marker-size"}},[r("b-form-select",{staticStyle:{width:"100%","text-align":"center",padding:"0.5rem 0rem"},attrs:{id:"marker-size",options:e.sizeOptions},model:{value:e.form.size,callback:function(r){e.$set(e.form,"size",r)},expression:"form.size"}})],1),r("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-condition-group",label:"Condition","label-for":"marker-condition"}},[r("b-form-input",{attrs:{id:"marker-condition"},model:{value:e.form.condition,callback:function(r){e.$set(e.form,"condition",r)},expression:"form.condition"}})],1),r("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-height-group",label:"Flying Height","label-for":"marker-height"}},[r("b-form-input",{attrs:{id:"marker-height",type:"number",min:"0"},model:{value:e.form.height,callback:function(r){e.$set(e.form,"height",r)},expression:"form.height"}})],1)],1)],1)],1),r("b-row",{staticStyle:{"text-align":"center",height:"30%"}},[r("b-col",{staticStyle:{"text-align":"center",height:"100%"}},[r("svg",{attrs:{width:"100%",height:"100%",viewBox:"0 0 400 400"}},[r("g",{staticClass:"entity-marker"},[e.form.condition.length>0?r("circle",{staticClass:"circle",attrs:{cx:200,cy:200,r:+e.form.size+4,fill:"none",stroke:"red","stroke-width":"5px","stroke-dasharray":"1",opacity:"0.7"}}):e._e(),r("circle",{staticClass:"border-circle",attrs:{fill:"black",cx:200,cy:200,r:+e.form.size}}),r("circle",{attrs:{fill:e.form.color,cx:200,cy:200,r:+e.form.size-2}}),r("text",{staticClass:"marker-name",style:`font-size: ${+e.form.size/2}px`,attrs:{x:200,y:200,fill:e.form.fontColor,"text-anchor":"middle",dy:".3em"}},[e._v(" "+e._s(e.form.name)+" ")]),r("text",{staticClass:"condition-text",style:"font-size: 12px;",attrs:{x:200,y:200+e.form.size+16,"text-anchor":"middle",fill:"#000"}},[e._v(" "+e._s(e.form.condition)+" ")]),r("text",{staticClass:"height-text",style:`font-size: ${e.form.size/3}px;`,attrs:{x:200,y:200+e.form.size/1.2,"text-anchor":"middle",fill:"#000"}},[e._v(" "+e._s(e.formHeight)+" ")])])])])],1),r("b-row",{staticStyle:{"text-align":"center"}},[r("b-col",[e.marker?e._e():r("b-button",{attrs:{variant:"success"},on:{click:e.createMarker}},[e._v("Add Marker")]),e.marker?r("b-button",{attrs:{variant:"success"},on:{click:e.updateMarker}},[e._v(" Update Marker ")]):e._e(),e.marker?r("b-button",{staticStyle:{"margin-left":"1rem"},attrs:{variant:"secondary"},on:{click:e.deselectMarker}},[e._v(" Cancel ")]):e._e()],1)],1)],1)},M=[],y=i["default"].extend({name:"MarkerBuilder",props:{marker:m},mounted(){this.marker&&(this.form.name=this.marker.name,this.form.color=this.marker.color,this.form.fontColor=this.marker.fontColor,this.form.size=this.marker.radius,this.form.condition=this.marker.condition,this.form.height=this.marker.height)},data(){return{form:{name:"",color:"#00BFFF",fontColor:"#000",size:40,condition:"",height:0},formDefaults:{name:"",color:"#00BFFF",fontColor:"#000",size:40,condition:"",height:0},sizeOptions:[{text:"Tiny",value:20},{text:"Small/Medium",value:40},{text:"Large",value:80},{text:"Huge",value:120},{text:"Gargantuan",value:160}]}},methods:{submit(e){e.preventDefault(),console.log("submitted"),this.marker?this.updateMarker():this.createMarker()},createMarker(){this.$emit("createMarker",this.form),this.form.name="",this.form.condition="",this.form.height=0},updateMarker(){this.marker.setName(this.form.name),this.marker.setColor(this.form.color),this.marker.setFontColor(this.form.fontColor),this.marker.setRadius(+this.form.size),this.marker.setCondition(this.form.condition),this.marker.setHeight(this.form.height),this.$emit("updateMarker"),this.form=Object.assign({},this.formDefaults)},removeMarker(){this.marker&&(this.$emit("removeMarker",this.marker.id),this.form=Object.assign({},this.formDefaults))},deselectMarker(){this.$emit("cancelEdit"),this.form=Object.assign({},this.formDefaults)}},computed:{formHeight(){return+this.form.height>0?`${this.form.height}ft`:""}},watch:{marker:function(e){e&&(this.form.name=e.name,this.form.color=e.color,this.form.fontColor=e.fontColor,this.form.size=e.radius,this.form.condition=e.condition,this.form.height=e.height)}}}),x=y,C=(0,g.Z)(x,v,M,!1,null,null,null),w=C.exports,_=t(7851);const O=`https://${window.location.host}`,z=(0,_.io)(O);z.on("connect",(()=>{console.log("connected to server"),z.emit("getMarkers")})),z.on("disconnect",(()=>{console.log("disconnected from server")}));var S=z,$=i["default"].extend({name:"BattleMap",components:{EntityMarker:b,MarkerBuilder:w},mounted(){this.map=new l,S.on("markerError",(e=>{this.$bvToast.toast(e,{title:"Marker Error",variant:"warning"})})),S.on("addMarker",(e=>{const r=JSON.parse(e),t=new m(r.name,r.color,r.fontColor,r.x,r.y,r.radius,r.condition,r.height,r.id);this.map.addMarker(t)})),S.on("markerMoved",(e=>{const r=JSON.parse(e),t=this.map.markers.find((e=>e.id===r.id));t&&t.moveMarkerToSmooth(r.x,r.y)})),S.on("removeMarker",(e=>{this.map.removeMarker(e)})),S.on("updateMarkerTraits",(e=>{const r=JSON.parse(e),t=this.map.markers.find((e=>e.id===r.id));t&&(t.setName(r.name),t.setColor(r.color),t.setFontColor(r.fontColor),t.setRadius(r.radius),t.setCondition(r.condition),t.setHeight(r.height))})),window.addEventListener("resize",(()=>{this.pageResized=!this.pageResized}))},data(){return{map:new l,selectedMarker:void 0,selectedMarkerRef:void 0,editingMarker:void 0,isDragging:!1,currentLocation:{x:0,y:0},pageResized:!1}},methods:{addMarker(e){const{name:r,color:t,fontColor:i,size:o,condition:a,height:s}=e,n=new m(r,t,i,500,500,+o,a,s);this.map.addMarker(n),S.emit("addMarker",n.toString())},onMousemove(e){if(e.preventDefault(),this.selectedMarker&&this.isDragging&&this.screenCTM){const r=(e.clientX-this.screenCTM.e)/this.screenCTM.a,t=(e.clientY-this.screenCTM.f)/this.screenCTM.d;this.selectedMarker.moveMarkerTo(r,t)}this.currentLocation={x:e.clientX,y:e.clientY}},markerMoved(e){S.emit("moveMarker",JSON.stringify(e))},removeMarker(e){this.map.removeMarker(e),this.editingMarker=void 0,S.emit("removeMarker",e)},pickUpMarker(e){this.selectedMarker=e.marker,this.selectedMarkerRef=e.ref,this.isDragging=!0},putDownMarker(){if(this.selectedMarker&&this.isDragging){if(this.isDragging=!1,this.selectedMarkerTrashHover)return void this.removeMarker(this.selectedMarker.id);const e={id:this.selectedMarker.id,x:this.selectedMarker.x,y:this.selectedMarker.y};S.emit("moveMarker",JSON.stringify(e))}},editMarker(e){this.editingMarker=e},updateMarker(){if(!this.editingMarker)return;const e=JSON.stringify(this.editingMarker);this.editingMarker=void 0,S.emit("updateMarkerTraits",e)},cancelEditMarker(){this.editingMarker=void 0}},computed:{markers(){return this.map.getMarkers()},screenCTM(){this.pageResized;const e=this.$refs.map;return e.getScreenCTM()},selectedMarkerTrashHover(){if(this.currentLocation.x,this.currentLocation.y,!this.selectedMarkerRef)return!1;const e=this.$refs.trashArea,r=this.selectedMarkerRef.getBoundingClientRect(),t=e.getBoundingClientRect();return!(r.right<t.left||r.left>t.right||r.bottom<t.top||r.top>t.bottom)},trashAreaStyle(){const e=this.isDragging?"0":"-10%",r=this.selectedMarkerTrashHover?"red":"#000";return{"--trash-bottom":e,"--trash-bg-color":r}}}}),T=$,j=(0,g.Z)(T,s,n,!1,null,"9197f8a8",null),D=j.exports,P=i["default"].extend({name:"App",components:{BattleMap:D}}),H=P,B=(0,g.Z)(H,o,a,!1,null,null,null),R=B.exports,E=t(3702),F=t(9425),N=t(7581);t(7024);i["default"].use(E.XG7),i["default"].use(F.A7),i["default"].use(N.m$),i["default"].config.productionTip=!1,S.connect(),new i["default"]({render:e=>e(R)}).$mount("#app")}},r={};function t(i){var o=r[i];if(void 0!==o)return o.exports;var a=r[i]={exports:{}};return e[i].call(a.exports,a,a.exports,t),a.exports}t.m=e,function(){var e=[];t.O=function(r,i,o,a){if(!i){var s=1/0;for(m=0;m<e.length;m++){i=e[m][0],o=e[m][1],a=e[m][2];for(var n=!0,l=0;l<i.length;l++)(!1&a||s>=a)&&Object.keys(t.O).every((function(e){return t.O[e](i[l])}))?i.splice(l--,1):(n=!1,a<s&&(s=a));if(n){e.splice(m--,1);var c=o();void 0!==c&&(r=c)}}return r}a=a||0;for(var m=e.length;m>0&&e[m-1][2]>a;m--)e[m]=e[m-1];e[m]=[i,o,a]}}(),function(){t.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(r,{a:r}),r}}(),function(){t.d=function(e,r){for(var i in r)t.o(r,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:r[i]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(r){return 0===e[r]};var r=function(r,i){var o,a,s=i[0],n=i[1],l=i[2],c=0;if(s.some((function(r){return 0!==e[r]}))){for(o in n)t.o(n,o)&&(t.m[o]=n[o]);if(l)var m=l(t)}for(r&&r(i);c<s.length;c++)a=s[c],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(m)},i=self["webpackChunkui"]=self["webpackChunkui"]||[];i.forEach(r.bind(null,0)),i.push=r.bind(null,i.push.bind(i))}();var i=t.O(void 0,[998],(function(){return t(3115)}));i=t.O(i)})();
//# sourceMappingURL=app.203ef102.js.map