(function(){"use strict";var e={6658:function(e,r,t){var o=t(6369),a=function(){var e=this,r=e._self._c;e._self._setupProxy;return r("div",{attrs:{id:"app"}},[r("BattleMap")],1)},i=[],n=function(){var e=this,r=e._self._c;e._self._setupProxy;return r("b-container",{staticClass:"battle-map",attrs:{fluid:""}},[r("b-row",{staticClass:"fullHeight"},[r("b-col",{staticClass:"fullHeight",staticStyle:{"padding-left":"0","padding-right":"1px"}},[r("svg",{ref:"map",staticClass:"battle-map-svg",attrs:{width:"100%",height:"100%",viewBox:"0 0 1000 1000"},on:{mousemove:e.onMousemove,mouseup:e.putDownMarker}},e._l(e.markers,(function(t,o){return r("EntityMarker",{key:`${t.name}-${o}`,attrs:{marker:t,dragging:e.isDragging},on:{editMarker:e.editMarker,pickUp:e.pickUpMarker}})})),1)]),r("b-col",{staticClass:"fullHeight d-none d-lg-block",attrs:{lg:"3"}},[r("MarkerBuilder",{attrs:{marker:e.editingMarker},on:{createMarker:e.addMarker,updateMarker:e.updateMarker,cancelEdit:e.cancelEditMarker,removeMarker:e.removeMarker}})],1)],1)],1)},s=[];t(7658);class l{constructor(){Object.defineProperty(this,"markers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.markers=[]}getMarkers(){return this.markers}addMarker(e){this.markers.push(e)}removeMarker(e){this.markers=this.markers.filter((r=>r.id!==e))}}var c=t(3029);class m{constructor(e,r,t,o,a,i,n){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=null!==n&&void 0!==n?n:(0,c.Z)(),this.name=e,this.color=r,this.fontColor=t,this.x=o,this.y=a,this.radius=i}setName(e){this.name=e}setColor(e){this.color=e}setFontColor(e){this.fontColor=e}setRadius(e){this.radius=e}moveMarkerTo(e,r){this.x=e,this.y=r}moveMarkerToSmooth(e,r){const t=e-this.x,o=r-this.y,a=t/100,i=o/100;let n=0;const s=setInterval((()=>{100===n?clearInterval(s):(this.x+=a,this.y+=i,n+=1)}),1)}toString(){return JSON.stringify({id:this.id,name:this.name,color:this.color,fontColor:this.fontColor,x:this.x,y:this.y,radius:this.radius})}}var u=function(){var e=this,r=e._self._c;e._self._setupProxy;return r("g",{ref:"marker",staticClass:"entity-marker",style:e.markerStyles,on:{mousedown:e.pickUp,contextmenu:function(r){return e.edit.apply(null,arguments)}}},[r("circle",{staticClass:"border-circle",attrs:{fill:"black",cx:e.marker.x,cy:e.marker.y,r:e.marker.radius+2}}),r("circle",{attrs:{fill:e.marker.color,cx:e.marker.x,cy:e.marker.y,r:e.marker.radius}}),r("text",{staticClass:"marker-name",style:"font-size: "+e.marker.radius/2,attrs:{x:e.marker.x,y:e.marker.y,fill:e.marker.fontColor,"text-anchor":"middle",dy:".3em"}},[e._v(" "+e._s(e.marker.name)+" ")])])},f=[],d=function(e,r,t,o){function a(e){return e instanceof t?e:new t((function(r){r(e)}))}return new(t||(t=Promise))((function(t,i){function n(e){try{l(o.next(e))}catch(r){i(r)}}function s(e){try{l(o["throw"](e))}catch(r){i(r)}}function l(e){e.done?t(e.value):a(e.value).then(n,s)}l((o=o.apply(e,r||[])).next())}))},k=o["default"].extend({name:"EntityMarker",props:{marker:m,dragging:Boolean},methods:{pickUp(e){return d(this,void 0,void 0,(function*(){e.preventDefault(),2!==e.button&&this.$emit("pickUp",this.marker)}))},edit(e){e.preventDefault(),this.$emit("editMarker",this.marker)}},computed:{markerStyles(){const e=this.dragging?"grabbing":"grab";return{"--hover-cursor":e}}}}),h=k,p=t(1001),b=(0,p.Z)(h,u,f,!1,null,"7593d470",null),v=b.exports,g=function(){var e=this,r=e._self._c;e._self._setupProxy;return r("b-container",{staticClass:"marker-builder",attrs:{fluid:""}},[r("b-row",{staticStyle:{"margin-bottom":"1rem"}},[r("b-col",[r("h3",[e._v("Add New Marker")])])],1),r("b-row",[r("b-col",[r("b-form",{on:{submit:e.submit}},[r("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-name-group",label:"Label","label-for":"marker-label"}},[r("b-form-input",{attrs:{id:"marker-label",type:"text"},model:{value:e.form.name,callback:function(r){e.$set(e.form,"name",r)},expression:"form.name"}})],1),r("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-color-group",label:"Marker Color","label-for":"marker-color"}},[r("b-form-input",{attrs:{id:"marker-color",type:"color"},model:{value:e.form.color,callback:function(r){e.$set(e.form,"color",r)},expression:"form.color"}})],1),r("b-form-group",{staticClass:"marker-form-group",attrs:{id:"input-font-color-group",label:"Font Color","label-for":"marker-color"}},[r("b-form-input",{attrs:{id:"marker-font-color",type:"color"},model:{value:e.form.fontColor,callback:function(r){e.$set(e.form,"fontColor",r)},expression:"form.fontColor"}})],1),r("b-form-group",{attrs:{id:"input-name-group",label:"Size","label-for":"marker-size"}},[r("b-form-select",{attrs:{id:"marker-size",options:e.sizeOptions},model:{value:e.form.size,callback:function(r){e.$set(e.form,"size",r)},expression:"form.size"}})],1)],1)],1)],1),r("b-row",{staticStyle:{"text-align":"center"}},[r("b-col",[r("svg",{attrs:{width:"100%",height:"100%",viewBox:"0 0 300 300"}},[r("g",{staticClass:"entity-marker"},[r("circle",{staticClass:"border-circle",attrs:{fill:"black",cx:150,cy:150,r:+e.form.size+2}}),r("circle",{attrs:{fill:e.form.color,cx:150,cy:150,r:+e.form.size}}),r("text",{staticClass:"marker-name",style:"font-size: "+ +e.form.size/2,attrs:{x:150,y:150,fill:e.form.fontColor,"text-anchor":"middle",dy:".3em"}},[e._v(" "+e._s(e.form.name)+" ")])])])])],1),r("b-row",{staticStyle:{"text-align":"center"}},[r("b-col",[e.marker?e._e():r("b-button",{attrs:{variant:"success"},on:{click:e.createMarker}},[e._v("Add Marker")]),e.marker?r("b-button",{attrs:{variant:"success"},on:{click:e.updateMarker}},[e._v(" Update Marker ")]):e._e(),e.marker?r("b-button",{staticStyle:{"margin-left":"1rem"},attrs:{variant:"secondary"},on:{click:e.deselectMarker}},[e._v(" Cancel ")]):e._e()],1)],1),r("b-row",{staticStyle:{"text-align":"center","margin-top":"3rem"}},[r("b-col",[e.marker?r("b-button",{attrs:{variant:"danger"},on:{click:e.removeMarker}},[e._v("Remove Marker")]):e._e()],1)],1)],1)},M=[],y=o["default"].extend({name:"MarkerBuilder",props:{marker:m},mounted(){this.marker&&(this.form.name=this.marker.name,this.form.color=this.marker.color,this.form.fontColor=this.marker.fontColor,this.form.size=this.marker.radius)},data(){return{form:{name:"",color:"#00BFFF",fontColor:"#000",size:50},formDefaults:{name:"",color:"#00BFFF",fontColor:"#000",size:50},sizeOptions:[{text:"Tiny",value:25},{text:"Small/Medium",value:50},{text:"Large",value:100},{text:"Huge",value:150},{text:"Gargantuan",value:200}]}},methods:{submit(e){e.preventDefault(),this.marker?this.updateMarker():this.createMarker()},createMarker(){this.$emit("createMarker",this.form),this.form.name=""},updateMarker(){this.marker.setName(this.form.name),this.marker.setColor(this.form.color),this.marker.setFontColor(this.form.fontColor),this.marker.setRadius(+this.form.size),this.$emit("updateMarker"),this.form=Object.assign({},this.formDefaults)},removeMarker(){this.marker&&(this.$emit("removeMarker",this.marker.id),this.form=Object.assign({},this.formDefaults))},deselectMarker(){this.$emit("cancelEdit"),this.form=Object.assign({},this.formDefaults)}},watch:{marker:function(e){e&&(this.form.name=e.name,this.form.color=e.color,this.form.fontColor=e.fontColor,this.form.size=e.radius)}}}),x=y,C=(0,p.Z)(x,g,M,!1,null,null,null),w=C.exports,_=t(7851);const O=`https://${window.location.host}`,S=(0,_.io)(O);S.on("connect",(()=>{console.log("connected to server"),S.emit("getMarkers")})),S.on("disconnect",(()=>{console.log("disconnected from server")}));var z=S,T=o["default"].extend({name:"BattleMap",components:{EntityMarker:v,MarkerBuilder:w},mounted(){this.map=new l,z.on("markerError",(e=>{this.$bvToast.toast(e,{title:"Marker Error",variant:"warning"})})),z.on("addMarker",(e=>{const r=JSON.parse(e),t=new m(r.name,r.color,r.fontColor,r.x,r.y,r.radius,r.id);this.map.addMarker(t)})),z.on("markerMoved",(e=>{const r=JSON.parse(e),t=this.map.markers.find((e=>e.id===r.id));t&&t.moveMarkerToSmooth(r.x,r.y)})),z.on("removeMarker",(e=>{this.map.removeMarker(e)})),z.on("updateMarkerTraits",(e=>{const r=JSON.parse(e),t=this.map.markers.find((e=>e.id===r.id));t&&(t.setName(r.name),t.setColor(r.color),t.setFontColor(r.fontColor),t.setRadius(r.radius))})),window.addEventListener("resize",(()=>{this.pageResized=!this.pageResized}))},data(){return{map:new l,selectedMarker:void 0,editingMarker:void 0,isDragging:!1,currentLocation:{x:0,y:0},pageResized:!1}},methods:{addMarker(e){const{name:r,color:t,fontColor:o,size:a}=e,i=new m(r,t,o,500,500,+a);this.map.addMarker(i),z.emit("addMarker",i.toString())},onMousemove(e){if(e.preventDefault(),this.selectedMarker&&this.isDragging&&this.screenCTM){const r=(e.clientX-this.screenCTM.e)/this.screenCTM.a,t=(e.clientY-this.screenCTM.f)/this.screenCTM.d;this.selectedMarker.moveMarkerTo(r,t)}this.currentLocation={x:e.clientX,y:e.clientY}},markerMoved(e){z.emit("moveMarker",JSON.stringify(e))},removeMarker(e){this.map.removeMarker(e),this.editingMarker=void 0,z.emit("removeMarker",e)},pickUpMarker(e){this.selectedMarker=e,this.isDragging=!0},putDownMarker(){if(this.selectedMarker&&this.isDragging){this.isDragging=!1;const e={id:this.selectedMarker.id,x:this.selectedMarker.x,y:this.selectedMarker.y};z.emit("moveMarker",JSON.stringify(e))}},editMarker(e){this.editingMarker=e},updateMarker(){if(!this.editingMarker)return;const e=JSON.stringify(this.editingMarker);this.editingMarker=void 0,z.emit("updateMarkerTraits",e)},cancelEditMarker(){this.editingMarker=void 0}},computed:{markers(){return this.map.getMarkers()},screenCTM(){this.pageResized;const e=this.$refs.map;return e.getScreenCTM()}}}),j=T,P=(0,p.Z)(j,n,s,!1,null,"773064a1",null),$=P.exports,D=o["default"].extend({name:"App",components:{BattleMap:$}}),B=D,E=(0,p.Z)(B,a,i,!1,null,null,null),F=E.exports,N=t(3702),R=t(9425),J=t(7581);t(7024);o["default"].use(N.XG7),o["default"].use(R.A7),o["default"].use(J.m$),o["default"].config.productionTip=!1,z.connect(),new o["default"]({render:e=>e(F)}).$mount("#app")}},r={};function t(o){var a=r[o];if(void 0!==a)return a.exports;var i=r[o]={exports:{}};return e[o].call(i.exports,i,i.exports,t),i.exports}t.m=e,function(){var e=[];t.O=function(r,o,a,i){if(!o){var n=1/0;for(m=0;m<e.length;m++){o=e[m][0],a=e[m][1],i=e[m][2];for(var s=!0,l=0;l<o.length;l++)(!1&i||n>=i)&&Object.keys(t.O).every((function(e){return t.O[e](o[l])}))?o.splice(l--,1):(s=!1,i<n&&(n=i));if(s){e.splice(m--,1);var c=a();void 0!==c&&(r=c)}}return r}i=i||0;for(var m=e.length;m>0&&e[m-1][2]>i;m--)e[m]=e[m-1];e[m]=[o,a,i]}}(),function(){t.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(r,{a:r}),r}}(),function(){t.d=function(e,r){for(var o in r)t.o(r,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(r){return 0===e[r]};var r=function(r,o){var a,i,n=o[0],s=o[1],l=o[2],c=0;if(n.some((function(r){return 0!==e[r]}))){for(a in s)t.o(s,a)&&(t.m[a]=s[a]);if(l)var m=l(t)}for(r&&r(o);c<n.length;c++)i=n[c],t.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return t.O(m)},o=self["webpackChunkui"]=self["webpackChunkui"]||[];o.forEach(r.bind(null,0)),o.push=r.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(6658)}));o=t.O(o)})();
//# sourceMappingURL=app.9a1bf429.js.map